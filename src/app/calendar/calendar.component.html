<!-- <button mat-button (click)="onTest()">TESTUJ</button> -->
<div *ngIf="isLoading">
  <app-custom-loading></app-custom-loading>
</div>
<div *ngIf="!isLoading">
  <div class="calendar-header">
    <div [routerLink]="['', 'app', 'menu']" class="calendar-header--menu-icon">
      <ic-icon icon="menuGridO"></ic-icon>
    </div>
    <div (click)="swipeRight()" class="calendar-header--left-icon">
      <ic-icon icon="arrowLeftAlt2"></ic-icon>
    </div>
    <div (click)="setCurrentMonth()" class="calendar-header--date">
      {{ displayedDate | date: "MMMM yyyy" }}
    </div>
    <div (click)="swipeLeft()" class="calendar-header--right-icon">
      <ic-icon icon="arrowRightAlt2"></ic-icon>
    </div>
    <div (click)="addEvent()" class="calendar-header--add-icon">
      <ic-icon icon="plusLine"></ic-icon>
    </div>
  </div>
  <table
    (swipeleft)="swipeLeft()"
    (swipeRight)="swipeRight()"
    class="calendar-table"
    [ngClass]="{
      'calendar-table--swipingRight': swipingRight,
      'calendar-table--swipingLeft': swipingLeft
    }"
    *ngIf="calendar"
  >
    <thead>
      <tr>
        <th i18n="1Day">Mo</th>
        <th i18n="2Day">Tu</th>
        <th i18n="3Day">We</th>
        <th i18n="4Day">Th</th>
        <th i18n="5Day">Fr</th>
        <th i18n="6Day">Sa</th>
        <th i18n="7Day">Su</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let row of calendar | chunk: 7; let i = index">
        <td
          matRipple
          [matRippleCentered]="true"
          [matRippleRadius]="15"
          (click)="onDateClick(c)"
          class="calendar-day"
          [ngClass]="{ 'past-date': c.isPastDate, today: c.isToday }"
          *ngFor="let c of row; let j = index"
        >
          <div
            class="calendar-day-header"
            [ngClass]="{
              'blue-date': c.isToday,
              'not-this-month': c.date.getMonth() !== monthSelected,
              'active-date': c.isClicked
            }"
          >
            <p
              [ngClass]="{ 'has-event': c.hasEvent }"
              class="calendar-day-number"
            >
              {{ c.date.getDate() }}
            </p>
          </div>
        </td>
      </tr>
    </tbody>
  </table>

  <p class="day-header">
    {{ calendarDayInstance.date | date: "dd. MMMM" }}
  </p>

  <div *ngIf="calendarDayInstance.events.length > 0" class="events mb-2rem">
    <div class="wrapper-flex-center flex-column">
      <div
        mat-ripple
        *ngFor="let event of calendarDayInstance.events; let i = index"
        class="width-100 pointer mt-05rem"
      >
        <div class="flex flex-align-center flex-space-between">
          <div class="events__row--title ml-1rem">{{ event.name }}</div>
          <div class="events__row--date">
            <span
              ><span class="events__row--date--hours" *ngIf="isSingleDayEvent(event) || isFirstDayEvent(event)">
                {{ event.startDate | date: "HH:mm" }}
              </span>
              <span *ngIf="!isSingleDayEvent(event) && !isFirstDayEvent(event)">
                {{ event.startDate | date: "dd MMM" }}
              </span>
              -
              <span *ngIf="isSingleDayEvent(event) || isLastDayEvent(event)">
                {{ event.endDate | date: "HH:mm" }}
              </span>
              <span *ngIf="!isSingleDayEvent(event) && !isLastDayEvent(event)">
                {{ event.endDate | date: "dd MMM" }}
              </span> </span
            ><span i18n="allDay" *ngIf="event.allDay">Whole day</span>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div
    *ngIf="
      calendarDayInstance.events.length < 1 &&
      !(calendarDayInstance.date.getTime() < today)
    "
    class="wrapper-flex-center flex-column pb-3"
  >
    <div class="no-events__title">No events scheduled for this day</div>
    <button
      (click)="addEvent()"
      class="bttn bttn-primary bttn-violet bttn-clickable bttn-medium mt-2rem"
    >
      Add Event
    </button>
  </div>
  <div
    *ngIf="
      calendarDayInstance.events.length < 1 &&
      calendarDayInstance.date.getTime() < today
    "
    class="wrapper-flex-center flex-column pb-3"
  >
    <div class="no-events__title">There was no events planned this day.</div>
  </div>
</div>
<div class="mt-7rem"></div>
